(function(){var g,f,c,h,e,a;var b=Object.prototype.hasOwnProperty,d=function(l,j){for(var i in j){if(b.call(j,i)){l[i]=j[i]}}function k(){this.constructor=l}k.prototype=j.prototype;l.prototype=new k;l.__super__=j.prototype;return l};a=(function(){function i(j,k){if(j==null){j=0}if(k==null){k=0}this.set(j,k)}i.prototype.set=function(j,k){if(j==null){j=0}if(k==null){k=0}this.x=j;this.y=k;return this};i.prototype.add=function(j){this.x+=j.x;this.y+=j.y;return this};i.prototype.sub=function(j){this.x-=j.x;this.y-=j.y;return this};i.prototype.scale=function(j){this.x*=j;this.y*=j;return this};i.prototype.div=function(j){this.x/=j;this.y/=j;return this};i.prototype.product=function(j){return this.x*j.x+this.y*j.y};i.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};i.prototype.truncate=function(j){if(this.length()){this.scale(j/this.length())}return this};i.prototype.normalize=function(){return this.truncate(1)};i.prototype.angle=function(){return(180*Math.atan2(this.y,this.x))/Math.PI};i.prototype.rotate=function(l){var j,k;j=(l*Math.PI)/180;k=this.length();this.x=Math.sin(j)*this.y+Math.cos(j)*this.x;this.y=Math.cos(j)*this.y-Math.sin(j)*this.x;return this.truncate(k)};i.prototype.clone=function(){return new i(this.x,this.y)};i.prototype.reverse=function(){this.x*=-1;this.y*=-1;return this};return i})();Array.prototype._index=function(i){var j;if(i<0){j=this.length;return j+i}return i};Array.prototype.at=function(i){return this[this._index(i)]};Array.prototype.map=function(i){var k,j;return([].splice.apply(this,[0,this.length-0].concat(j=(function(){var n,m,l;l=[];for(n=0,m=this.length;n<m;n++){k=this[n];l.push(i(k))}return l}).call(this))),j)};Array.prototype.clone=function(){return this.dup()};Array.prototype.dup=function(){return this.slice(0,this.length)};Array.prototype.each=function(j){var i,k;for(i=0,k=this.length;0<=k?i<k:i>k;0<=k?i++:i--){j(this[i],i)}return this};Array.prototype.deleteAt=function(i){i=this._index(i);if(i>=this.length){return}return this.splice(i,1)};Array.prototype.deleteIf=function(k){var j;return this.replace((function(){var l,i;i=[];for(j=0,l=this.length;0<=l?j<l:j>l;0<=l?j++:j--){if(!k(this[j],j)){i.push(this[j])}}return i}).call(this))};Array.prototype.reject=function(i){var j;j=this.length;this.deleteIf(i);if(j===this.length){return}return this};Array.prototype.isEmpty=function(){return this.length===0};Array.prototype.isEql=function(i,l){var j,k;if(l==null){l=function(n,m){return n===m}}if(this.length!==i.length){return false}for(j=0,k=this.length;0<=k?j<k:j>k;0<=k?j++:j--){if(!l(this[j],i[j])){return false}}return true};Array.prototype.fill=function(m,n,j){var k,l;if(n==null){n=0}if(j==null){j=this.length-1}n=this._index(n);j=this._index(j);[].splice.apply(this,[n,j-n+1].concat(l=(function(){var i;i=[];for(k=n;n<=j?k<=j:k>=j;n<=j?k++:k--){i.push(m)}return i})())),l;return this};Array.prototype.first=function(){return this[0]};Array.prototype.last=function(){var i;i=this._index(-1);return this[i]};Array.prototype.uniq=function(m){var l,k,j,i;if(m==null){m=function(o,n){return o===n}}l=[];for(j=0,i=this.length;j<i;j++){k=this[j];if(!l.isInclude(k,m)){l.push(k)}}return this.replace(l)};Array.prototype.index=function(k,l){var i,j;if(l==null){l=function(n,m){return n===m}}for(i=0,j=this.length;0<=j?i<j:i>j;0<=j?i++:i--){if(l(this[i],k)){return i}}return};Array.prototype.indexes=function(){var k,l,j,i;i=[];for(l=0,j=arguments.length;l<j;l++){k=arguments[l];i.push(this.at(k))}return i};Array.prototype.rindex=function(k,l){var i,j;if(l==null){l=function(n,m){return n===m}}for(i=j=this.length;j<=0?i<0:i>0;j<=0?i++:i--){if(l(this[i],k)){return i}}return};Array.prototype.flatten=function(){return this.replace(this.reduce(function(j,i){return j.concat(i instanceof Array?i.flatten():i)},[]))};Array.prototype.transpose=function(){var n,m,l,k,j,o;k=this.isEmpty()?0:this.length;n=this.first() instanceof Array?this.first().length:0;if(!k||!n){return this}l=(function(){var i;i=[];for(m=0;0<=n?m<n:m>n;0<=n?m++:m--){i.push([])}return i})();for(j=0;0<=k?j<k:j>k;0<=k?j++:j--){for(o=0;0<=n?o<n:o>n;0<=n?o++:o--){l[o][j]=this[j][o]}}return this.replace(l)};Array.prototype.compact=function(){return this.deleteIf(function(i){return i===void 0})};Array.prototype.isInclude=function(l,m){var j,k,i;if(m==null){m=function(o,n){return o===n}}for(k=0,i=this.length;k<i;k++){j=this[k];if(m(j,l)){return true}}return false};Array.prototype.size=function(){return this.length};Array.prototype.swap=function(j,i){var k;j=this._index(j);i=this._index(i);k=this[j];this[j]=this[i];this[i]=k;return this};Array.prototype.shuffle=function(){var j,k;for(j=0,k=this.length;0<=k?j<k:j>k;0<=k?j++:j--){this.swap(j,Math.floor(Math.random()*this.length))}return this};Array.prototype.choice=function(){return this[Math.floor(Math.random()*this.length)]};Array.prototype.count=function(l,m){var i,j,k;if(m==null){m=function(o,n){return o===n}}j=0;for(i=0,k=this.length;0<=k?i<k:i>k;0<=k?i++:i--){if(m(this[i],l)){++j}}return j};Array.prototype.replace=function(i){var k,l,j;this.clear();for(l=0,j=i.length;l<j;l++){k=i[l];this.push(k)}return this};Array.prototype.nitems=function(){return this.clone().compact().size()};Array.prototype.insert=function(){var l,m,k,j,n;l=Array.prototype.slice.call(arguments,0,arguments.length);if(l.size()<=1){return this}k=this._index(l[0]);j=l.slice(1,this.length);for(m=0,n=j.length;0<=n?m<n:m>n;0<=n?m++:m--){this.splice(k+m,0,j[m])}return this};Array.prototype.clear=function(){var i;i=[];while(!this.isEmpty()){i.push(this.deleteAt(0))}return i};Array.prototype.max=function(j){var i;if(j==null){j=function(l,k){if(l===k){return 0}if(l<k){return -1}else{return 1}}}i=this.first();this.reduce(function(l,k){if(j(i,k)<0){return i=k}});return i};Array.prototype.min=function(j){var i;if(j==null){j=function(l,k){if(l===k){return 0}if(l<k){return -1}else{return 1}}}i=this.first();this.reduce(function(l,k){if(j(i,k)>=0){return i=k}});return i};e=(function(){function i(j,l,n,m,k){if(l==null){l=false}if(n==null){n=0}if(m==null){m=false}if(k==null){k=void 0}this.set(j);this._time=n;this._active=m;this._complete=k;this._repeat=l}i.prototype.set=function(j){if(j==null){j=0}this._max=j;return this};i.prototype.play=function(){this._active=true;return this};i.prototype.stop=function(){this._active=false;this._time=0;return this};i.prototype.pause=function(){this._active=false;return this};i.prototype.tick=function(){if(this._time<this._max&&this._active){++this._time;if(this._time===this._max){if(typeof complete==="undefined"||complete===null){this._complete()}if(this._repeat){this._time=0}}}return this};i.prototype.now=function(){return time};i.prototype.setComplete=function(j){var k;this._complete=(k=typeof j===Function)!=null?k:{func:void 0};return this};i.prototype.setRepeat=function(j){this._repeat=j;return this};return i})();enchant();f=(function(){i.prototype.config={WIDTH:640,HEIGHT:480,FPS:30,IMAGE_PATH:"resources/images/",IMAGES:["miku.gif"],SOUND_PATH:"resources/sounds/",SOUNDS:[]};function i(){var m,l,j,k;this.game=new Game(this.config.WIDTH,this.config.HEIGHT);this.game.fps=this.config.FPS;this.game.keybind(90,"a");k=this.config.IMAGES;for(l=0,j=k.length;l<j;l++){m=k[l];this.game.preload(""+this.config.IMAGE_PATH+m)}this.game.onload=function(){this.stage=new h();i.game.stage=this.stage;return this.rootScene.addChild(this.stage)};this.game.start();i.game=this.game;i.config=this.config}return i})();window.onload=function(){return new f()};h=(function(){d(i,Group);function i(){var j;i.__super__.constructor.apply(this,arguments);j=new c(138,288);this.addChild(j);this.addEventListener("enterframe",this.update);this.count=0}i.prototype.update=function(){return false};return i})();g=(function(){d(i,Sprite);function i(k,l,j,m){if(j==null){j=0}if(m==null){m=0}i.__super__.constructor.call(this,k,l);this.addEventListener("enterframe",this.update);this.x=j;this.y=m;this.v=new a()}i.prototype.update=function(j){this.x+=this.v.x;return this.y+=this.v.y};i.prototype.setImage=function(j){return this.image=f.game.assets[""+f.config.IMAGE_PATH+j]};i.prototype.setOpacity=function(n){var o,m,l,j,p,k;l=this.image.width;o=this.image.height;console.log("opacity");k=[];for(j=0;0<=l?j<l:j>l;0<=l?j++:j--){k.push((function(){var q;q=[];for(p=0;0<=o?p<o:p>o;0<=o?p++:p--){console.log(this.image.getPixel());m=this.image.getPixel();q.push(this.image.setPixel(j,p,m[0],m[1],m[2],n))}return q}).call(this))}return k};return i})();c=(function(){d(i,g);function i(j,k){if(j==null){j=0}if(k==null){k=0}i.__super__.constructor.call(this,42,32,j,k);this.setImage("miku.gif");this.speed=7;this.pressA=false}i.prototype.update=function(j){this.v.set(0,0);if(f.game.input.left){this.v.x=-1}else{if(f.game.input.right){this.v.x=1}}if(f.game.input.up){this.v.y=-1}else{if(f.game.input.down){this.v.y=1}}this.v.truncate(this.speed);i.__super__.update.apply(this,arguments);if(this.x>f.config.WIDTH-this.width){this.x=f.config.WIDTH-this.width}else{if(this.x<0){this.x=0}}if(this.y>f.config.HEIGHT-this.height){this.y=f.config.HEIGHT-this.height}else{if(this.y<0){this.y=0}}if(f.game.input.a){if(!this.pressA){f.game.stage.count+=1;this.setOpacity(0.5);this.pressA=true;return console.log(f.game.stage.count)}}else{return this.pressA=false}};return i})()}).call(this);